<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì‹œì¥ ì§€í‘œ ëŒ€ì‹œë³´ë“œ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>window.tailwind=window.tailwind||{};tailwind.config={darkMode:'class'};</script>
  <style>
    .card { border-radius: 1rem; box-shadow: 0 10px 30px rgba(0,0,0,.08); padding: 1rem; }
    .line-clamp-3 { display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
  </style>
</head>

<body class="min-h-screen bg-gradient-to-b from-zinc-50 to-zinc-100 dark:from-black dark:to-zinc-950 text-zinc-900 dark:text-zinc-100">
  <!-- í—¤ë” -->
  <header class="sticky top-0 z-50 bg-white/70 dark:bg-zinc-900/70 backdrop-blur border-b border-zinc-200/60 dark:border-zinc-800/60">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center gap-3">
      <div class="text-xl font-bold">ğŸ“Š ì‹œì¥ ì§€í‘œ ëŒ€ì‹œë³´ë“œ</div>
      <div class="ml-auto flex items-center gap-2 text-sm">
        <button id="themeToggle" class="px-3 py-1 rounded-xl border border-zinc-300 dark:border-zinc-700">ë¼ì´íŠ¸/ë‹¤í¬</button>
      </div>
    </div>
  </header>

  <!-- ë©”ì¸ -->
  <main class="max-w-6xl mx-auto p-4 space-y-4">

    <!-- ì£¼ìš” ì§€ìˆ˜/í™˜ìœ¨ -->
    <section class="card">
      <div class="text-lg font-semibold mb-2">ì£¼ìš” ì§€ìˆ˜/í™˜ìœ¨ ë¹ ë¥¸ ë³´ê¸°</div>
      <div class="tv-wrap" style="height:60px;">
        <div class="tradingview-widget-container">
          <div class="tradingview-widget-container__widget"></div>
          <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-ticker-tape.js" async>
          {
            "symbols": [
              {"proName": "FOREXCOM:SPXUSD", "title": "S&P 500"},
              {"proName": "NASDAQ:NDX", "title": "NASDAQ 100"},
              {"proName": "TVC:USOIL", "title": "WTI í˜„ë¬¼"},
              {"proName": "FX_IDC:USDKRW", "title": "USD/KRW"},
              {"proName": "BITSTAMP:BTCUSD", "title": "BTC/USD"}
            ],
            "showSymbolLogo": true,
            "colorTheme": "dark",
            "isTransparent": true,
            "displayMode": "adaptive",
            "locale": "kr"
          }
          </script>
        </div>
      </div>
    </section>

    <!-- WatcherGuru í…”ë ˆê·¸ë¨ í”¼ë“œ -->
    <section class="card">
      <div class="text-lg font-semibold mb-2">WatcherGuru ìµœì‹  ì†Œì‹</div>
      <div id="tg-wg"></div>
    </section>

    <!-- ê²½ì œì§€í‘œ ìº˜ë¦°ë” -->
    <section class="card">
      <div class="text-lg font-semibold mb-2">ì´ë²ˆ ì£¼ ê²½ì œì§€í‘œ ìº˜ë¦°ë”</div>
      <div class="tv-wrap" style="height:420px;">
        <div class="tradingview-widget-container">
          <div class="tradingview-widget-container__widget"></div>
          <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-events.js" async>
          {
            "colorTheme": "dark",
            "isTransparent": true,
            "width": "100%",
            "height": "100%",
            "locale": "kr",
            "importanceFilter": "1",
            "countryFilter": "us,kr,cn"
          }
          </script>
        </div>
      </div>
    </section>

    <footer class="py-6 text-center text-xs opacity-70">Â© ê°œì¸ íˆ¬ì ëŒ€ì‹œë³´ë“œ Â· ìë£Œ: TradingView</footer>
  </main>

  <!-- ìŠ¤í¬ë¦½íŠ¸ -->
  <script>
    // í…Œë§ˆ í† ê¸€
    const btn=document.getElementById('themeToggle');
    const root=document.documentElement;
    function setTheme(m){if(m==='dark'){root.classList.add('dark');localStorage.setItem('theme','dark');}else{root.classList.remove('dark');localStorage.setItem('theme','light');}}
    const saved=localStorage.getItem('theme');
    if(saved){setTheme(saved);}else{setTheme(window.matchMedia('(prefers-color-scheme: dark)').matches?'dark':'light');}
    btn.addEventListener('click',()=>{setTheme(root.classList.contains('dark')?'light':'dark');});

    // Cloudflare Worker ì„¤ì •
    const WORKER_BASE = "https://wo-de-telegram-proxy.snupil38kor.workers.dev";

    async function loadWatcherGuru(){
      const el=document.getElementById('tg-wg');
      el.innerHTML = `
        <div class="rounded-xl border border-zinc-200/60 dark:border-zinc-800/60 p-3">
          <div class="font-semibold mb-2">WatcherGuru</div>
          <div class="animate-pulse h-24 rounded-lg bg-zinc-200/60 dark:bg-zinc-800/60"></div>
        </div>`;
      try {
        const res = await fetch(\`\${WORKER_BASE}/api?ch=WatcherGuru\`);
        if(!res.ok) throw new Error('fetch failed');
        const data = await res.json();
        const items = data?.items || [];
        const top = items.slice(0,6).map(it => {
          const link = it.url || it.link || '#';
          const date = new Date(it.date_published || it.pubDate).toLocaleString('ko-KR');
          const text = (it.content_text || it.description || '').replace(/<[^>]*>/g,'');
          return `
            <a class="block rounded-xl border border-zinc-200/60 dark:border-zinc-800/60 p-3 hover:bg-zinc-100/60 dark:hover:bg-zinc-800/40 transition" target="_blank" href="\${link}">
              <div class="text-xs opacity-70">\${date}</div>
              <div class="font-medium my-1">\${it.title || '(ë¬´ì œ)'}</div>
              <p class="text-sm opacity-90 line-clamp-3">\${text}</p>
            </a>`;
        }).join('');
        el.innerHTML = `
          <div class="rounded-xl border border-zinc-200/60 dark:border-zinc-800/60">
            <div class="flex items-center justify-between p-3">
              <div class="font-semibold">WatcherGuru</div>
              <div class="text-xs opacity-70">via Cloudflare Worker</div>
            </div>
            <div class="grid md:grid-cols-2 gap-2 p-3 pt-0">\${top}</div>
          </div>`;
      } catch (e) {
        el.innerHTML = `
          <div class="rounded-xl border border-amber-300/60 dark:border-amber-700/60 p-3 bg-amber-50/60 dark:bg-amber-900/20">
            <div class="font-semibold mb-1">WatcherGuru</div>
            <p class="text-sm opacity-80 mb-2">í”¼ë“œë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</p>
            <a class="inline-block px-3 py-2 text-sm rounded-xl border border-zinc-300 dark:border-zinc-700" target="_blank" href="https://t.me/s/WatcherGuru">ì±„ë„ ì—´ê¸°</a>
          </div>`;
      }
    }

    loadWatcherGuru();
  </script>
</body>
</html>
